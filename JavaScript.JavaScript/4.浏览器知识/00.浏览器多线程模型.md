# 浏览器多线程模型

浏览器每创建一个tab，就会创建一个进程，该进程间由如下的多线程模型构成：

- 主线程
    - 可以理解为下面互斥的 GUI渲染线程 和 JS引擎线程，在执行谁，谁就是主线程

- GUI渲染线程（主线程）
    - 负责页面渲染，包括HTML和CSS解析，构建DOM树、布局和绘制等
    - 与JS引擎线程互斥，所以js代码如果堵塞，页面就会很卡
    - 任务队列空闲时，主线程才会执行GUI渲染

- JS引擎线程（主线程）
    - 负责处理JS脚本和代码，包括各种异步事件的回调
    - 与GUI渲染线程互斥(虽然实现上属于不同线程，但为了怕互相影响，特意做成像是一个线程一样互斥)

- 事件触发线程（工作线程）
    - 负责将事件加入到任务队列尾部，包括用户触发点击事件，下面的 定时器到期 和 异步请求成功

- 定时器触发线程（工作线程）
    - 负责异步定时器的计数
    - 执行代码时如果遇到定时器，就交给该线程处理，计数完毕后，就通知事件触发线程将回调加入任务队列尾部，等待JS引擎线程执行

- 异步http请求线程（工作线程）
    - 负责异步请求的监测
    - 执行代码如果遇到异步请求，就交给该线程处理，当监测到状态码变更，就通知事件触发线程将回调加入任务队列尾部，等待JS引擎线程执行

- web works 等用户执行耗时任务的线程（工作线程）
    - 用户使用web worker单独开启的计算任务线程，为了不让耗时任务在主线程中造成堵塞
